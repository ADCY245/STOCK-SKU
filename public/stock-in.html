<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Stock - Stock Management</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <h1>Stock Management System</h1>
        <nav>
            <a href="index.html">Dashboard</a>
            <a href="stock-in.html">Stock In</a>
            <a href="products.html">Products</a>
            <a href="stock-out.html">Stock Out</a>
            <a href="reports.html">Reports</a>
            <a href="sku.html">SKU Generator</a>
        </nav>
    </header>
    <main>
        <h2>Add Stock</h2>
        
        <!-- Excel Upload Section -->
        <div class="upload-section">
            <h3>Upload Excel File</h3>
            <input type="file" id="excel-file" accept=".xlsx,.xls" />
            <button type="button" onclick="uploadExcel()">Upload Excel</button>
            <button type="button" class="template-button" onclick="downloadTemplate()">Download Template</button>
            <p id="upload-status"></p>
        </div>

        <div class="divider">OR</div>

        <!-- Manual Entry Form -->
        <div class="manual-entry">
            <h3>Manual Entry</h3>
            <form id="stock-in-form">
                <div class="form-row">
                    <label for="product-type">Product Type:</label>
                    <select id="product-type" onchange="loadProductNames()" required>
                        <option value="blankets" selected>Blankets</option>
                        <option value="underpacking">Underpacking</option>
                        <option value="litho perf">Litho Perf</option>
                        <option value="rules">Rules</option>
                        <option value="matrix">Matrix</option>
                        <option value="chemicals">Chemicals</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="product-name">Product Name:</label>
                    <input type="text" id="product-name" placeholder="Enter product name" required>
                </div>

                <div class="form-row">
                    <label for="imported">Imported:</label>
                    <select id="imported" onchange="toggleImportDate()" required>
                        <option value="true" selected>Yes</option>
                        <option value="false">No</option>
                    </select>
                </div>

                <div class="form-row" id="import-date-row">
                    <label for="import-date">Date of Import:</label>
                    <input type="date" id="import-date">
                </div>

                <!-- Blankets/Underpacking Fields -->
                <div id="blanket-fields" class="product-fields">
                    <div class="form-row">
                        <label for="width">Across:</label>
                        <input type="number" id="width" step="0.01" required onchange="calculateSqMtr()">
                        <select id="width-unit" onchange="calculateSqMtr()">
                            <option value="mm">mm</option>
                            <option value="mtr">mtr</option>
                            <option value="inch">inch</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="length">Around:</label>
                        <input type="number" id="length" step="0.01" required onchange="calculateSqMtr()">
                        <select id="length-unit" onchange="calculateSqMtr()">
                            <option value="mm">mm</option>
                            <option value="mtr">mtr</option>
                            <option value="inch">inch</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="thickness">Thickness:</label>
                        <input type="number" id="thickness" step="0.01" required>
                        <select id="thickness-unit">
                            <option value="mm">mm</option>
                            <option value="micron">micron</option>
                        </select>
                    </div>
                </div>

                <!-- Litho Perf Fields -->
                <div id="litho-perf-fields" class="product-fields" style="display: none;">
                    <div class="form-row">
                        <label for="product-tpi">Product TPI:</label>
                        <input type="number" id="product-tpi" step="0.1" placeholder="Optional">
                    </div>

                    <div class="form-row">
                        <label for="litho-piece-type">Product Piece Type:</label>
                        <select id="litho-piece-type" required>
                            <option value="">Select Piece Type</option>
                            <option value="card">Card</option>
                            <option value="paper">Paper</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="perforation-type">Perforation Type:</label>
                        <select id="perforation-type" required>
                            <option value="">Select Perforation Type</option>
                            <option value="center">Center</option>
                            <option value="side">Side</option>
                            <option value="center-micro perf">Center Micro Perf</option>
                            <option value="side-micro perf">Side Micro Perf</option>
                            <option value="center score">Center Score</option>
                            <option value="center slit">Center Slit</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="litho-stock">Product Stock:</label>
                        <input type="number" id="litho-stock" step="1" min="0" placeholder="Enter stock quantity" required>
                        <span style="margin-left: 10px; color: #666;">pkts</span>
                    </div>
                </div>

                <!-- Chemicals Fields -->
                <div id="chemical-fields" class="product-fields" style="display: none;">
                    <div class="form-row">
                        <label for="product-format">Product Format:</label>
                        <select id="product-format" required>
                            <option value="">Select Format</option>
                            <option value="1">1</option>
                            <option value="5">5</option>
                            <option value="25">25</option>
                            <option value="200">200</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="chemical-unit">Product Type:</label>
                        <select id="chemical-unit" required>
                            <option value="">Select Unit</option>
                            <option value="kg">kg</option>
                            <option value="ltr">ltr</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="chemical-stock">Product Stock:</label>
                        <input type="number" id="chemical-stock" step="0.01" required onchange="calculateChemicalContainers()">
                        <span id="stock-unit-display" style="margin-left: 10px; color: #666;"></span>
                    </div>

                    <div class="form-row" id="container-result" style="background: #f0f8ff; padding: 10px; border-radius: 5px;">
                        <strong>Available: 0 containers</strong>
                    </div>
                </div>

                <!-- Creasing Matrix Fields -->
                <div id="matrix-fields" class="product-fields" style="display: none;">
                    <div class="form-row">
                        <label for="matrix-format">Product Format:</label>
                        <select id="matrix-format" required>
                            <option value="">Select Format</option>
                            <option value="9 MM">9 MM</option>
                            <option value="11 MM">11 MM</option>
                            <option value="13 MM">13 MM</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="matrix-size-width">Product Size:</label>
                        <input type="number" id="matrix-size-width" step="0.01" placeholder="Width" required>
                        <span style="margin: 0 10px;">x</span>
                        <input type="number" id="matrix-size-height" step="0.01" placeholder="Height" required>
                    </div>

                    <div class="form-row">
                        <label for="matrix-stock">Product Stock:</label>
                        <input type="number" id="matrix-stock" step="1" min="0" placeholder="Enter stock quantity" required>
                        <span style="margin-left: 10px; color: #666;">pkts</span>
                    </div>
                </div>

                <!-- Rules Fields -->
                <div id="rules-fields" class="product-fields" style="display: none;">
                    <div class="form-row">
                        <label for="rule-format">Product Format:</label>
                        <select id="rule-format" required>
                            <option value="">Select Format</option>
                            <option value="creasing rule">Creasing Rule</option>
                            <option value="cutting rule">Cutting Rule</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="rule-container-length">Container Size:</label>
                        <input type="number" id="rule-container-length" step="0.01" placeholder="Length" required>
                        <span style="margin: 0 10px;">x</span>
                        <input type="number" id="rule-container-width" step="0.01" placeholder="Width" required>
                        <span style="margin: 0 10px;">x</span>
                        <select id="rule-container-type" required>
                            <option value="">Select Type</option>
                            <option value="2pt">2pt</option>
                            <option value="3pt">3pt</option>
                            <option value="label rule">Label Rule</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="rule-packed-as">Product Packed As:</label>
                        <select id="rule-packed-as" required>
                            <option value="">Select Packing</option>
                            <option value="coil">Coil</option>
                            <option value="packets">Packets</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label for="rule-stock">Product Stock:</label>
                        <input type="number" id="rule-stock" step="1" min="0" placeholder="Enter stock quantity" required>
                        <span id="rule-stock-unit" style="margin-left: 10px; color: #666;">coils</span>
                    </div>
                </div>

                <!-- Common Fields -->
                <div class="form-row">
                    <label for="stock-type">Stock Type:</label>
                    <select id="stock-type" onchange="toggleStockType()" required>
                        <option value="">Select Stock Type</option>
                        <option value="roll" selected>Roll</option>
                        <option value="pieces">Cut Pieces</option>
                    </select>
                </div>

                <div class="form-row" id="roll-number-row">
                    <label for="roll-number">Roll Number:</label>
                    <input type="text" id="roll-number">
                </div>

                <!-- Roll-specific fields -->
                <div id="roll-fields" style="display: none;">
                    <div class="form-row">
                        <label for="sq-mtr">Sq. Mtr (Calculated):</label>
                        <input type="number" id="sq-mtr" step="0.01" readonly>
                    </div>
                </div>

                <!-- Pieces-specific fields -->
                <div id="pieces-fields" style="display: none;">
                    <div class="form-row">
                        <label for="number-of-pieces">Number of Pieces:</label>
                        <input type="number" id="number-of-pieces" step="1" min="1" onchange="calculatePiecesSqMtr()">
                    </div>
                    <div class="form-row">
                        <label for="pieces-sq-mtr">Sq. Mtr (Calculated):</label>
                        <input type="number" id="pieces-sq-mtr" step="0.01" readonly>
                    </div>
                </div>

                <div class="form-row">
                    <label for="taken-date">Item Stock Taken On Date:</label>
                    <input type="date" id="taken-date">
                </div>

                <button type="submit">Add Stock</button>
            </form>
        </div>
    </main>
    <script src="js/api.js"></script>
    <script src="js/stock.js"></script>
</body>
</html>
