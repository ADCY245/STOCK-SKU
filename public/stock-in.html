<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Stock - Stock Management</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <h1>Stock Management System</h1>
        <nav>
            <a href="index.html">Dashboard</a>
            <a href="stock-in.html">Stock In</a>
            <a href="products.html">Products</a>
            <a href="stock-out.html">Stock Out</a>
            <a href="reports.html">Reports</a>
            <a href="sku.html">SKU Generator</a>
        </nav>
    </header>
    <main>
        <h2>Add Stock</h2>
        
        <!-- Excel Upload Section -->
        <div class="upload-section">
            <h3>Upload Excel File</h3>
            <input type="file" id="excel-file" accept=".xlsx,.xls" />
            <button type="button" onclick="uploadExcel()">Upload Excel</button>
            <button type="button" class="template-button" onclick="downloadTemplate()">Download Template</button>
            <p id="upload-status"></p>
        </div>

        <div class="divider">OR</div>

        <!-- Manual Entry Form -->
        <div class="manual-entry">
            <h3>Manual Entry</h3>
            <form id="stock-in-form">
                <div class="form-row">
                    <label for="product-type">Product Type:</label>
                    <select id="product-type" onchange="loadProductNames()" required>
                        <option value="">Select Product Type</option>
                        <option value="blankets">Blankets</option>
                        <option value="litho perf">Litho Perf</option>
                        <option value="underpacking">Underpacking</option>
                        <option value="rules">Rules</option>
                        <option value="matrix">Matrix</option>
                        <option value="chemicals">Chemicals</option>
                        <option value="film">Film</option>
                        <option value="plate">Plate</option>
                        <option value="ink">Ink</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="product-name">Product Name:</label>
                    <input type="text" id="product-name" placeholder="Enter product name" required>
                </div>

                <div class="form-row">
                    <label for="length">Length:</label>
                    <input type="number" id="length" step="0.01" required onchange="calculateSqMtr()">
                    <select id="length-unit" onchange="calculateSqMtr()">
                        <option value="mm">mm</option>
                        <option value="mtr">mtr</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="width">Width:</label>
                    <input type="number" id="width" step="0.01" required onchange="calculateSqMtr()">
                    <select id="width-unit" onchange="calculateSqMtr()">
                        <option value="mm">mm</option>
                        <option value="mtr">mtr</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="thickness">Thickness:</label>
                    <input type="number" id="thickness" step="0.01" required>
                    <select id="thickness-unit">
                        <option value="mm">mm</option>
                        <option value="micron">micron</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="roll-number">Roll Number:</label>
                    <input type="text" id="roll-number" required>
                </div>

                <div class="form-row">
                    <label for="import-date">Date of Import:</label>
                    <input type="date" id="import-date">
                </div>

                <div class="form-row">
                    <label for="taken-date">Item Stock Taken On Date:</label>
                    <input type="date" id="taken-date">
                </div>

                <div class="form-row">
                    <label for="sq-mtr">Sq. Mtr (Calculated):</label>
                    <input type="number" id="sq-mtr" step="0.01" readonly>
                </div>

                <button type="submit">Add Stock</button>
            </form>
        </div>
    </main>
    <script src="js/api.js"></script>
    <script src="js/stock.js"></script>
</body>
</html>
